{"version":3,"file":"usePageInfo.js","sourceRoot":"","sources":["../../../src/client/composables/usePageInfo.ts"],"names":[],"mappings":"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","sourcesContent":["import { getDate } from \"@vuepress/helper/client\";\nimport type { GitData } from \"@vuepress/plugin-git\";\nimport {\n  useReadingTimeData,\n  useReadingTimeLocale,\n} from \"@vuepress/plugin-reading-time/client\";\nimport type { ComputedRef } from \"vue\";\nimport { computed, inject } from \"vue\";\nimport { useFrontmatter } from \"vuepress/client\";\n\nimport type { PageInfoProps } from \"@theme-hope/components/info/PageInfo\";\nimport type { CategoryMapRef } from \"@theme-hope/composables/blog/useCategoryMap\";\nimport type { TagMapRef } from \"@theme-hope/composables/blog/useTagMap\";\nimport { useData } from \"@theme-hope/composables/useData\";\nimport type { PageCategory, PageTag } from \"@theme-hope/utils/info/typings\";\n\nimport { useAuthorInfo } from \"./useAuthorInfo.js\";\nimport type {\n  AuthorInfo,\n  PageInfoType,\n  ThemeBasePageFrontmatter,\n} from \"../../shared/index.js\";\nimport { getAuthor, getCategory, getTag } from \"../../shared/index.js\";\n\nexport const usePageAuthor = (): ComputedRef<AuthorInfo[]> => {\n  const frontmatter = useFrontmatter<ThemeBasePageFrontmatter>();\n  const authorInfo = useAuthorInfo();\n\n  return computed(() => {\n    const { author } = frontmatter.value;\n\n    if (author) return getAuthor(author);\n    if (author === false) return [];\n\n    return getAuthor(authorInfo.value, false);\n  });\n};\n\nexport const usePageCategory = (): ComputedRef<PageCategory[]> => {\n  const frontmatter = useFrontmatter<ThemeBasePageFrontmatter>();\n  const categoryMap = inject<CategoryMapRef | null>(\n    Symbol.for(\"categoryMap\"),\n    null,\n  );\n\n  return computed(() =>\n    getCategory(frontmatter.value.category ?? frontmatter.value.categories).map(\n      (name) => ({\n        name,\n        path: categoryMap?.value.map[name]?.path ?? \"\",\n      }),\n    ),\n  );\n};\n\nexport const usePageTag = (): ComputedRef<PageTag[]> => {\n  const frontmatter = useFrontmatter<ThemeBasePageFrontmatter>();\n  const tagMap = inject<TagMapRef | null>(Symbol.for(\"tagMap\"), null);\n\n  return computed(() =>\n    getTag(frontmatter.value.tag ?? frontmatter.value.tags).map((name) => ({\n      name,\n      path: tagMap?.value.map[name]?.path ?? \"\",\n    })),\n  );\n};\n\nexport const usePageDate = (): ComputedRef<Date | null> => {\n  const { frontmatter, page } = useData<\n    ThemeBasePageFrontmatter,\n    { git?: GitData }\n  >();\n\n  return computed(() => {\n    const date = getDate(frontmatter.value.date);\n\n    if (date) return date;\n\n    const { createdTime } = page.value.git ?? {};\n\n    if (createdTime) return new Date(createdTime);\n\n    return null;\n  });\n};\n\nexport const usePageInfo = (): {\n  info: ComputedRef<PageInfoProps>;\n  items: ComputedRef<PageInfoType[] | false | null>;\n} => {\n  const { frontmatter, themeLocale } = useData();\n  const author = usePageAuthor();\n  const category = usePageCategory();\n  const tag = usePageTag();\n  const date = usePageDate();\n  const readingTimeData = useReadingTimeData();\n  const readingTimeLocale = useReadingTimeLocale();\n\n  const info = computed(\n    () =>\n      ({\n        author: author.value,\n        category: category.value,\n        date: date.value,\n        tag: tag.value,\n        isOriginal: frontmatter.value.isOriginal ?? false,\n        readingTime: readingTimeData.value,\n        readingTimeLocale: readingTimeLocale.value,\n        pageview: frontmatter.value.pageview ?? true,\n      }) as PageInfoProps,\n  );\n\n  const items = computed(\n    () => frontmatter.value.pageInfo ?? themeLocale.value.pageInfo ?? null,\n  );\n\n  return { info, items };\n};\n"]}