{"version":3,"file":"VPPreview-Dzr-2ZZL.js","sources":["../../src/client/components/VPPreview.ts"],"sourcesContent":["import type { RequiredSlot } from '@vuepress/helper/client'\nimport { useLocale } from '@vuepress/helper/client'\nimport { useEventListener, useResizeObserver, useToggle } from '@vueuse/core'\nimport type { PropType, SlotsType, VNode } from 'vue'\nimport { defineComponent, h, ref, shallowRef, useId } from 'vue'\nimport type { MarkdownPreviewPluginLocaleConfig } from '../../shared/index.js'\n\nimport '../styles/vp-preview.css'\n\nexport interface VPPreviewProps {\n  /**\n   * Markdown preview title\n   *\n   * Markdown preview 标题\n   */\n  title?: string\n\n  /**\n   * Markdown preview locales\n   *\n   * Markdown preview 本地化配置\n   */\n  locales?: MarkdownPreviewPluginLocaleConfig\n}\n\nexport default defineComponent({\n  name: 'VPPreview',\n\n  props: {\n    /**\n     * Markdown preview title\n     *\n     * Markdown preview 标题\n     */\n    title: String,\n\n    /**\n     * Markdown preview locales\n     *\n     * Markdown preview 本地化配置\n     */\n    locales: {\n      type: Object as PropType<MarkdownPreviewPluginLocaleConfig>,\n      default: () => ({}),\n    },\n  },\n\n  slots: Object as SlotsType<{\n    content: RequiredSlot\n    code: RequiredSlot\n  }>,\n\n  setup(props, { slots }) {\n    // Generate unique ID for accessibility\n    const codeID = `vp-preview-${useId()}`\n\n    const locale = useLocale(props.locales)\n    const [isExpanded, toggleExpanded] = useToggle(false)\n    const codeContainer = shallowRef<HTMLDivElement>()\n    const height = ref('0')\n\n    const toggleCode = (): void => {\n      toggleExpanded()\n      height.value = isExpanded.value\n        ? `${codeContainer.value!.clientHeight}px`\n        : '0'\n    }\n\n    let isBeforePrintOpen: boolean = false\n\n    useEventListener('beforeprint', () => {\n      isBeforePrintOpen = isExpanded.value\n\n      toggleExpanded(true)\n    })\n\n    useEventListener('afterprint', () => {\n      if (isBeforePrintOpen) return\n\n      toggleExpanded()\n    })\n\n    useResizeObserver(codeContainer, () => {\n      if (isExpanded.value) {\n        height.value = `${codeContainer.value!.clientHeight}px`\n      }\n    })\n\n    return (): VNode =>\n      h(\n        'div',\n        { class: { 'vp-preview': true, 'is-expanded': isExpanded.value } },\n        [\n          h('div', { class: 'vp-preview-showcase' }, slots.content()),\n\n          h('div', { class: 'vp-preview-control' }, [\n            props.title\n              ? h(\n                  'div',\n                  { class: 'vp-preview-title' },\n                  decodeURIComponent(props.title),\n                )\n              : null,\n            h(\n              'button',\n              {\n                'type': 'button',\n                'class': 'vp-preview-toggle-button',\n                'title': locale.value.toggle,\n                'aria-label': locale.value.toggle,\n                'aria-controls': codeID,\n                'aria-expanded': isExpanded.value,\n                'onClick': () => {\n                  toggleCode()\n                },\n              },\n              h('div', { class: 'vp-preview-toggle-icon' }),\n            ),\n          ]),\n          h(\n            'div',\n            {\n              'id': codeID,\n              'class': 'vp-preview-code-wrapper',\n              'style': { height: height.value },\n              'data-allow-mismatch': 'attribute',\n            },\n            h(\n              'div',\n              { class: 'vp-preview-code', ref: codeContainer },\n              slots.code(),\n            ),\n          ),\n        ],\n      )\n  },\n})\n"],"names":["P","defineComponent","props","slots","codeID","useId","locale","useLocale","isExpanded","toggleExpanded","useToggle","codeContainer","shallowRef","height","ref","toggleCode","isBeforePrintOpen","useEventListener","useResizeObserver","h"],"mappings":"2PAyBA,IAAAA,EAAeC,EAAgB,CAC7B,KAAM,YAEN,MAAO,CAML,MAAO,OAOP,QAAS,CACP,KAAM,OACN,QAAS,KAAO,CAAA,EAClB,CACF,EAEA,MAAO,OAKP,MAAMC,EAAO,CAAE,MAAAC,CAAM,EAAG,CAEtB,MAAMC,EAAS,cAAcC,EAAAA,CAAO,GAE9BC,EAASC,EAAUL,EAAM,OAAO,EAChC,CAACM,EAAYC,CAAc,EAAIC,EAAU,EAAK,EAC9CC,EAAgBC,EAAAA,EAChBC,EAASC,EAAI,GAAG,EAEhBC,EAAa,IAAY,CAC7BN,EAAAA,EACAI,EAAO,MAAQL,EAAW,MACtB,GAAGG,EAAc,MAAO,YAAY,KACpC,GACN,EAEA,IAAIK,EAA6B,GAEjC,OAAAC,EAAiB,cAAe,IAAM,CACpCD,EAAoBR,EAAW,MAE/BC,EAAe,EAAI,CACrB,CAAC,EAEDQ,EAAiB,aAAc,IAAM,CAC/BD,GAEJP,EAAAA,CACF,CAAC,EAEDS,EAAkBP,EAAe,IAAM,CACjCH,EAAW,QACbK,EAAO,MAAQ,GAAGF,EAAc,MAAO,YAAY,KAEvD,CAAC,EAEM,IACLQ,EACE,MACA,CAAE,MAAO,CAAE,aAAc,GAAM,cAAeX,EAAW,KAAM,CAAE,EACjE,CACEW,EAAE,MAAO,CAAE,MAAO,qBAAsB,EAAGhB,EAAM,QAAA,CAAS,EAE1DgB,EAAE,MAAO,CAAE,MAAO,oBAAqB,EAAG,CACxCjB,EAAM,MACFiB,EACE,MACA,CAAE,MAAO,kBAAmB,EAC5B,mBAAmBjB,EAAM,KAAK,CAChC,EACA,KACJiB,EACE,SACA,CACE,KAAQ,SACR,MAAS,2BACT,MAASb,EAAO,MAAM,OACtB,aAAcA,EAAO,MAAM,OAC3B,gBAAiBF,EACjB,gBAAiBI,EAAW,MAC5B,QAAW,IAAM,CACfO,EAAAA,CACF,CACF,EACAI,EAAE,MAAO,CAAE,MAAO,wBAAyB,CAAC,CAC9C,CACF,CAAC,EACDA,EACE,MACA,CACE,GAAMf,EACN,MAAS,0BACT,MAAS,CAAE,OAAQS,EAAO,KAAM,EAChC,sBAAuB,WACzB,EACAM,EACE,MACA,CAAE,MAAO,kBAAmB,IAAKR,CAAc,EAC/CR,EAAM,MACR,CACF,CACF,CACF,CACJ,CACF,CAAC"}