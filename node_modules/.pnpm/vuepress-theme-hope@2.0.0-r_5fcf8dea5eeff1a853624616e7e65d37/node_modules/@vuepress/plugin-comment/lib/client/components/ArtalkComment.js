import{isString as p,LoadingIcon as f,wait as v}from"@vuepress/helper/client";import{watchImmediate as k}from"@vueuse/core";import{defineComponent as c,ref as g,shallowRef as h,computed as w,h as o,onMounted as y,watch as d,onUnmounted as S,nextTick as C}from"vue";import{useData as _}from"vuepress/client";import"artalk/dist/Artalk.css";import{u as M}from"../index-C4kzYjlG.js";var A=c({name:"ArtalkComment",props:{identifier:{type:String,required:!0},darkmode:Boolean},setup(t){const{page:i,site:l}=_(),a=M(),n=g(!1),u=h();let e=null;const s=w(()=>p(a.value.server)),m=async()=>{if(__VUEPRESS_SSR__)return;const[{default:r}]=await Promise.all([import("artalk/dist/Artalk.mjs"),v(a.value.delay??800)]);n.value=!0,await C(),e=r.init({useBackendConf:!1,site:l.value.title,pageTitle:i.value.title,...a.value,el:u.value,pageKey:t.identifier,darkMode:t.darkmode}),a.value.useBackendConf&&e.on("mounted",()=>{e.setDarkMode(t.darkmode)})};return y(()=>{k(()=>a.value,()=>{e?.destroy(),m()},{flush:"post"}),d(()=>t.identifier,()=>{e?.update({site:l.value.title,pageTitle:i.value.title,pageKey:t.identifier}),e?.reload()},{flush:"post"}),d(()=>t.darkmode,r=>{e?.setDarkMode(r)},{flush:"post"})}),S(()=>{e?.destroy()}),()=>s.value?o("div",{class:"artalk-wrapper"},[n.value?null:o(f),o("div",{ref:u})]):null}});export{A as default};
//# sourceMappingURL=ArtalkComment.js.map
