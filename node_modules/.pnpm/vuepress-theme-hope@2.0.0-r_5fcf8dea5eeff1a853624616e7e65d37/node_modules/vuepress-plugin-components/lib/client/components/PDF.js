import{isDef as S,isiPad as F,isMobile as L,isSafari as P,isLinkHttp as D,ensureEndingSlash as C,entries as $,useLocaleConfig as y}from"@vuepress/helper/client";import{useScrollLock as T}from"@vueuse/core";import{defineComponent as E,shallowRef as v,ref as R,h as f,watch as U,onMounted as _,onUnmounted as z}from"vue";import{CancelFullScreenIcon as I,EnterFullScreenIcon as N}from"vuepress-shared/client";import"../styles/pdf.scss";import{withBase as H}from"vuepress/client";import{u as M}from"../useSize-C8GaR9if.js";import{g as j}from"../getLink-DBmDl_2w.js";const m=e=>{console.error(`[PDF]: ${e}`)},k=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},B=e=>e instanceof HTMLElement?e:e==="string"?document.querySelector(e):document.body,J=e=>{let o=$(e).map(([r,l])=>r==="noToolbar"?`toolbar=${l?"0":"1"}`:`${encodeURIComponent(r)}=${encodeURIComponent(l)}`).join("&");return o&&(o=`#${o.slice(0,o.length-1)}`),o},w=(e,o,r,l,i)=>{k(o);const u=`${e==="pdfjs"?`${C(H(PDFJS_URL))}web/viewer.html?file=${encodeURIComponent(r)}`:r}${J(l)}`,a=e==="pdfjs"||e==="iframe"?"iframe":"embed",n=document.createElement(a);return n.className="pdf-viewer",n.type="application/pdf",n.title=i,n.src=u,n instanceof HTMLIFrameElement&&(n.allow="fullscreen"),o.classList.add("pdf-viewer-container"),o.appendChild(n),o.getElementsByTagName(a)[0]},x=(e,o,{title:r,hint:l,options:i={},force:u})=>{if(typeof window>"u"||!window?.navigator?.userAgent)return null;const{navigator:a}=window,{userAgent:n}=a,d=S(window.Promise),t=F(n)||L(n),p=!t&&P(n),h=!t&&/firefox/iu.test(n)&&n.split("rv:").length>1?parseInt(n.split("rv:")[1].split(".")[0],10)>18:!1,b=!t&&(d||h),s=B(o);if(!s)return m("Target element cannot be determined"),null;const c=D(e)?e:__VUEPRESS_DEV__?null:`${window.origin}${e}`,g=r??/\/([^/]+).pdf/.exec(e)?.[1]??"PDF Viewer";return u?c?PDFJS_URL?w("pdfjs",s,e,i,g):(s.innerHTML=l.replace(/\[url\]/g,c),m("PDFJS URL is not defined"),null):(m("PDF link is not accessible."),null):b||!t?w(p?"iframe":"embed",s,e,i,g):PDFJS_URL&&c?w("pdfjs",s,e,i,g):(s.innerHTML=l.replace(/\[url\]/g,e),m("This browser does not support embedded PDFs"),null)};var A=E({name:"PDF",props:{url:{type:String,required:!0},title:String,width:{type:[String,Number],default:"100%"},height:[String,Number],ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,noFullscreen:Boolean,zoom:[String,Number],viewer:Boolean},setup(e){const{el:o,width:r,height:l,resize:i}=M(e),u=y(PDF_LOCALES),a=v(),n=v(),d=T(a),t=R(!1);return U(t,p=>{d.value=p}),_(()=>{a.value=document.body,x(j(e.url),n.value,{title:e.title,hint:u.value.hint,options:{page:e.page,noToolbar:e.noToolbar,...e.zoom&&e.zoom.toString()!=="100"?{zoom:e.zoom}:{}},force:e.viewer}),i()}),z(()=>{d.value=!1}),()=>f("div",{class:["pdf-viewer-wrapper",{fullscreen:t.value}],ref:o,style:t.value?{}:{width:r.value,height:l.value}},[f("div",{ref:n}),e.noFullscreen?null:f("button",{class:"pdf-fullscreen-button",onClick:()=>{t.value=!t.value}},f(t.value?I:N,{class:"pdf-fullscreen-icon"}))])}});export{A as default};
//# sourceMappingURL=PDF.js.map
