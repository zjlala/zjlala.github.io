{"version":3,"file":"GiscusComment.js","sources":["../../../src/client/components/GiscusComment.ts"],"sourcesContent":["import { LoadingIcon } from '@vuepress/helper/client'\nimport type { VNode } from 'vue'\nimport { computed, defineComponent, h, onMounted, ref } from 'vue'\nimport { useLang } from 'vuepress/client'\nimport type {\n  GiscusInputPosition,\n  GiscusMapping,\n  GiscusRepo,\n  GiscusTheme,\n} from '../../shared/index.js'\nimport { useGiscusOptions } from '../helpers/index.js'\n\nimport '../styles/giscus.css'\n\n// Note: Should be updated with https://github.com/giscus/giscus/tree/main/locales\nconst SUPPORTED_LANGUAGES = [\n  'ar',\n  'be',\n  'bg',\n  'ca',\n  'cs',\n  'da',\n  'de',\n  'en',\n  'eo',\n  'es',\n  'eu',\n  'fa',\n  'fr',\n  'gr',\n  'hbs',\n  'he',\n  'hu',\n  'id',\n  'it',\n  'ja',\n  'kh',\n  'ko',\n  'nl',\n  'pl',\n  'pt',\n  'ro',\n  'ru',\n  'th',\n  'tr',\n  'uk',\n  'uz',\n  'vi',\n  'zh-CN',\n  'zh-HK',\n  'zh-TW',\n] as const\n\ntype BooleanString = '0' | '1'\n\nexport type GiscusLang = (typeof SUPPORTED_LANGUAGES)[number]\n\nexport type GiscusLoading = 'eager' | 'lazy'\n\nexport interface GiscusProps {\n  id?: string | undefined\n  repo: GiscusRepo\n  repoId: string\n  category?: string | undefined\n  categoryId?: string | undefined\n  mapping: GiscusMapping\n  term?: string | undefined\n  theme?: GiscusTheme | undefined\n  reactionsEnabled?: BooleanString | undefined\n  strict?: BooleanString | undefined\n  emitMetadata?: BooleanString | undefined\n  inputPosition?: GiscusInputPosition | undefined\n  lang?: GiscusLang | undefined\n  loading?: GiscusLoading | undefined\n}\n\nexport default defineComponent({\n  name: 'GiscusComment',\n\n  props: {\n    /**\n     * The identifier of the comment\n     *\n     * 评论标识符\n     */\n    identifier: {\n      type: String,\n      required: true,\n    },\n\n    /**\n     * Whether the component is in darkmode\n     *\n     * 组件是否处于夜间模式\n     */\n    darkmode: Boolean,\n  },\n\n  setup(props) {\n    const giscusOptions = useGiscusOptions()\n    const lang = useLang()\n\n    const enableGiscus = computed(() =>\n      Boolean(\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        giscusOptions.value.repo &&\n          giscusOptions.value.repoId &&\n          giscusOptions.value.category &&\n          giscusOptions.value.categoryId,\n      ),\n    )\n\n    const loaded = ref(false)\n\n    const giscusLang = computed(() => {\n      if (SUPPORTED_LANGUAGES.includes(lang.value as GiscusLang))\n        return lang.value\n\n      const shortCode = lang.value.split('-')[0] as GiscusLang\n\n      if (SUPPORTED_LANGUAGES.includes(shortCode)) return shortCode\n\n      return 'en'\n    })\n\n    const config = computed(\n      () =>\n        ({\n          repo: giscusOptions.value.repo,\n          repoId: giscusOptions.value.repoId,\n          category: giscusOptions.value.category,\n          categoryId: giscusOptions.value.categoryId,\n          lang: giscusLang.value,\n          theme: props.darkmode\n            ? giscusOptions.value.darkTheme || 'dark'\n            : giscusOptions.value.lightTheme || 'light',\n          mapping: giscusOptions.value.mapping || 'pathname',\n          term: props.identifier,\n          inputPosition: giscusOptions.value.inputPosition || 'top',\n          reactionsEnabled:\n            giscusOptions.value.reactionsEnabled === false ? '0' : '1',\n          strict: giscusOptions.value.strict === false ? '0' : '1',\n          loading: giscusOptions.value.lazyLoading === false ? 'eager' : 'lazy',\n          emitMetadata: '0',\n        }) as GiscusProps,\n    )\n\n    onMounted(async () => {\n      if (__VUEPRESS_SSR__) return\n\n      await import(/* webpackChunkName: \"giscus\" */ 'giscus')\n      loaded.value = true\n    })\n\n    return (): VNode | null =>\n      enableGiscus.value\n        ? h(\n            'div',\n            {\n              id: 'comment',\n              class: [\n                'giscus-wrapper',\n                { 'input-top': giscusOptions.value.inputPosition !== 'bottom' },\n              ],\n            },\n            loaded.value ? h('giscus-widget', config.value) : h(LoadingIcon),\n          )\n        : null\n  },\n})\n"],"names":["SUPPORTED_LANGUAGES","GiscusComment","defineComponent","props","giscusOptions","useGiscusOptions","lang","useLang","enableGiscus","computed","loaded","ref","giscusLang","shortCode","config","onMounted","h","LoadingIcon"],"mappings":"8QAeA,MAAMA,EAAsB,CAC1B,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,QACA,QACA,OACF,EAyBA,IAAAC,EAAeC,EAAgB,CAC7B,KAAM,gBAEN,MAAO,CAML,WAAY,CACV,KAAM,OACN,SAAU,EACZ,EAOA,SAAU,OACZ,EAEA,MAAMC,EAAO,CACX,MAAMC,EAAgBC,IAChBC,EAAOC,EAAAA,EAEPC,EAAeC,EAAS,IAC5B,GAEEL,EAAc,MAAM,MAClBA,EAAc,MAAM,QACpBA,EAAc,MAAM,UACpBA,EAAc,MAAM,WAE1B,EAEMM,EAASC,EAAI,EAAK,EAElBC,EAAaH,EAAS,IAAM,CAChC,GAAIT,EAAoB,SAASM,EAAK,KAAmB,EACvD,OAAOA,EAAK,MAEd,MAAMO,EAAYP,EAAK,MAAM,MAAM,GAAG,EAAE,CAAC,EAEzC,OAAIN,EAAoB,SAASa,CAAS,EAAUA,EAE7C,IACT,CAAC,EAEKC,EAASL,EACb,KACG,CACC,KAAML,EAAc,MAAM,KAC1B,OAAQA,EAAc,MAAM,OAC5B,SAAUA,EAAc,MAAM,SAC9B,WAAYA,EAAc,MAAM,WAChC,KAAMQ,EAAW,MACjB,MAAOT,EAAM,SACTC,EAAc,MAAM,WAAa,OACjCA,EAAc,MAAM,YAAc,QACtC,QAASA,EAAc,MAAM,SAAW,WACxC,KAAMD,EAAM,WACZ,cAAeC,EAAc,MAAM,eAAiB,MACpD,iBACEA,EAAc,MAAM,mBAAqB,GAAQ,IAAM,IACzD,OAAQA,EAAc,MAAM,SAAW,GAAQ,IAAM,IACrD,QAASA,EAAc,MAAM,cAAgB,GAAQ,QAAU,OAC/D,aAAc,GAChB,EACJ,EAEA,OAAAW,EAAU,SAAY,CAChB,mBAEJ,KAAM,QAAwC,QAAQ,EACtDL,EAAO,MAAQ,GACjB,CAAC,EAEM,IACLF,EAAa,MACTQ,EACE,MACA,CACE,GAAI,UACJ,MAAO,CACL,iBACA,CAAE,YAAaZ,EAAc,MAAM,gBAAkB,QAAS,CAChE,CACF,EACAM,EAAO,MAAQM,EAAE,gBAAiBF,EAAO,KAAK,EAAIE,EAAEC,CAAW,CACjE,EACA,IACR,CACF,CAAC"}