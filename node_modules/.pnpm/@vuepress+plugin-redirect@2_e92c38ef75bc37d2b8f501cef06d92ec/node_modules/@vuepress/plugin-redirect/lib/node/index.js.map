{"version":3,"file":"index.js","sources":["../../src/node/ensureRootHomePage.ts","../../src/node/logger.ts","../../src/node/generate/getLocaleRedirectHTML.ts","../../src/node/generate/generateAutoLocaleRedirectFiles.ts","../../src/node/generate/getRedirectHTML.ts","../../src/node/generate/generateRedirectFiles.ts","../../src/node/getRedirectLocaleConfig.ts","../../src/shared/normalizePath.ts","../../src/node/getRedirectMap.ts","../../src/node/handleRedirectTo.ts","../../src/node/locales.ts","../../src/node/redirectPlugin.ts"],"sourcesContent":["import type { App } from 'vuepress/core'\nimport { createPage } from 'vuepress/core'\n\nexport const ensureRootHomePage = async (app: App): Promise<void> => {\n  if (\n    // root homepage not exists\n    app.pages.every(({ path }) => path !== '/')\n  ) {\n    app.pages.push(\n      await createPage(app, {\n        path: '/',\n        frontmatter: { title: 'Home' },\n        // set markdown content\n        content: `\\\nRedirecting to the correct locale...\n`,\n      }),\n    )\n  }\n}\n","import { Logger } from '@vuepress/helper'\n\nexport const PLUGIN_NAME = '@vuepress/plugin-redirect'\n\nexport const logger = new Logger(PLUGIN_NAME)\n","import { removeEndingSlash } from '@vuepress/helper'\nimport type { RedirectBehaviorConfig } from '../../shared/index.js'\n\nexport const getLocaleRedirectHTML = (\n  {\n    config,\n    defaultBehavior,\n    defaultLocale,\n    localeFallback,\n  }: RedirectBehaviorConfig,\n  availableLocales: string[],\n  base: string,\n): string => `<!doctype html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"robots\" content=\"noindex\">\n  <title>Redirecting...</title>\n  <script>\n    const { hash, origin, pathname } = window.location;\n    const routePath = pathname.slice(${base.length});\n    const { languages } = window.navigator;\n    const anchor = hash.slice(1);\n\n    const config = ${JSON.stringify(config)};\n    const availableLocales = ${JSON.stringify(availableLocales)};\n    const defaultLocale = ${\n      availableLocales.includes(defaultLocale)\n        ? JSON.stringify(defaultLocale)\n        : 'availableLocales.pop()'\n    };\n    const defaultBehavior = ${JSON.stringify(defaultBehavior)}\n\n    let matchedLocalePath = null;\n\n    // get matched locale\n    findLanguage:\n      for (const lang of languages)\n        for (const [localePath, langs] of Object.entries(config))\n          if (langs.includes(lang)) {\n${\n  localeFallback\n    ? `\\\n            if (!availableLocales.includes(localePath))\n              continue;\n`\n    : ``\n}\\\n            matchedLocalePath = localePath;\n            break findLanguage;\n          }\n\n    // default link\n    const defaultLink = defaultLocale? \\`\\${origin}${removeEndingSlash(\n      base,\n    )}\\${defaultLocale}\\${routePath}\\${anchor? \\`#\\${anchor}\\`: \"\"}\\`: null;\n\n    // a locale matches\n    if (matchedLocalePath) {\n      const localeLink = \\`\\${origin}${removeEndingSlash(\n        base,\n      )}\\${matchedLocalePath}\\${routePath}\\${anchor? \\`#\\${anchor}\\`: \"\"}\\`;\n\n      if (availableLocales.includes(matchedLocalePath)) {\n        location.href = localeLink;\n      }\n      // the page does not exist\n      else {\n        // locale homepage\n        if (defaultBehavior === \"homepage\") {\n          location.href = \\`\\${origin}${removeEndingSlash(\n            base,\n          )}\\${matchedLocalePath}\\`;\n        }\n        // default locale page\n        else if (defaultBehavior === \"defaultLocale\" && defaultLink) {\n          location.href = defaultLink;\n        }\n        // as is to get a 404 page of that locale\n        else {\n          location.href = localeLink;\n        }\n      }\n    }\n    // we have a default page\n    else if (defaultLink) {\n      location.href = defaultLink;\n    }\n    else {\n      location.href = \\`\\${origin}${removeEndingSlash(base)}/404.html\\`;\n    }\n  </script>\n</head>\n<body>\n  <p>Redirecting...</p>\n</body>\n</html>\n`\n","import { entries, removeLeadingSlash } from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport { fs, path } from 'vuepress/utils'\nimport type { RedirectBehaviorConfig } from '../../shared/index.js'\nimport { logger } from '../logger.js'\nimport { getLocaleRedirectHTML } from './getLocaleRedirectHTML.js'\n\nexport const generateAutoLocaleRedirectFiles = async (\n  app: App,\n  localeOptions: RedirectBehaviorConfig,\n): Promise<void> => {\n  const rootPaths = app.pages\n    .filter(({ pathLocale }) => pathLocale === '/')\n    .map(({ path: pagePath }) => pagePath)\n  const localeRedirectMap: Record<string, string[]> = {}\n\n  app.pages\n    .filter(({ pathLocale }) => pathLocale !== '/')\n    .forEach(({ path: pagePath, pathLocale }) => {\n      const rootPath = pagePath\n        .replace(pathLocale, '/')\n        .replace(/\\/$/, '/index.html')\n\n      if (!rootPaths.includes(rootPath))\n        (localeRedirectMap[rootPath] ??= []).push(pathLocale)\n    })\n\n  const { succeed } = logger.load('Generating locale redirect files')\n\n  await Promise.all(\n    entries(localeRedirectMap).map(async ([rootPath, availableLocales]) => {\n      const filePath = app.dir.dest(removeLeadingSlash(rootPath))\n\n      if (!fs.existsSync(filePath)) {\n        await fs.ensureDir(path.dirname(filePath))\n        await fs.writeFile(\n          filePath,\n          getLocaleRedirectHTML(\n            localeOptions,\n            availableLocales,\n            app.siteData.base,\n          ),\n        )\n      }\n    }),\n  )\n\n  succeed()\n}\n","export const getRedirectHTML = (redirectUrl: string): string => `<!doctype html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"robots\" content=\"noindex\">\n  <meta http-equiv=\"refresh\" content=\"0; url=${redirectUrl}\">\n  <link rel=\"canonical\" href=\"${redirectUrl}\">\n  <title>Redirecting...</title>\n  <script>\n    const anchor = window.location.hash.slice(1);\n    window.location.replace(\\`${redirectUrl}\\${anchor? \\`#\\${anchor}\\`: \"\"}\\`);\n  </script>\n</head>\n<body>\n  <p>Redirecting...</p>\n</body>\n</html>\n`\n","import {\n  entries,\n  isLinkAbsolute,\n  isLinkHttp,\n  removeEndingSlash,\n  removeLeadingSlash,\n} from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport { fs, path } from 'vuepress/utils'\nimport { logger } from '../logger.js'\nimport { getRedirectHTML } from './getRedirectHTML.js'\n\nexport const generateRedirectFiles = async (\n  app: App,\n  config: Record<string, string>,\n  hostname = '',\n): Promise<void> => {\n  const resolvedHostname = hostname\n    ? removeEndingSlash(isLinkHttp(hostname) ? hostname : `https://${hostname}`)\n    : ''\n\n  const { succeed } = logger.load('Generating redirect files')\n\n  await Promise.all(\n    entries(config).map(async ([from, to]) => {\n      const filePath = app.dir.dest(removeLeadingSlash(from))\n\n      if (!fs.existsSync(filePath)) {\n        const redirectUrl = isLinkAbsolute(to)\n          ? `${resolvedHostname}${app.siteData.base}${removeLeadingSlash(to)}`\n          : to\n\n        await fs.ensureDir(path.dirname(filePath))\n        await fs.writeFile(filePath, getRedirectHTML(redirectUrl))\n      }\n    }),\n  )\n\n  succeed()\n}\n","import {\n  deepAssign,\n  entries,\n  fromEntries,\n  isArray,\n  isPlainObject,\n  keys,\n} from '@vuepress/helper'\nimport type { App } from 'vuepress/core'\nimport { colors } from 'vuepress/utils'\nimport type { RedirectBehaviorConfig } from '../shared/index.js'\nimport { logger } from './logger.js'\nimport type { RedirectPluginOptions } from './types/index.js'\n\nconst AVAILABLE_FALLBACK = ['defaultLocale', 'homepage', '404'] as const\n\nexport const getRedirectBehaviorConfig = (\n  app: App,\n  options: RedirectPluginOptions,\n): RedirectBehaviorConfig => {\n  const { locales } = app.siteData\n\n  const config = deepAssign(\n    fromEntries(\n      entries(locales)\n        .filter(([key, { lang }]) => {\n          if (!lang) {\n            logger.error(\n              `Missing ${colors.magenta(\n                'lang',\n              )} option for locale \"${key}\", this locale will be ignored!`,\n            )\n\n            return false\n          }\n\n          return true\n        })\n        .map(([key, { lang }]) => [key, [lang!]]),\n    ),\n    isPlainObject(options.localeConfig)\n      ? fromEntries(\n          entries(options.localeConfig).map(([routePath, lang]) => [\n            routePath,\n            isArray(lang) ? lang : [lang],\n          ]),\n        )\n      : {},\n  )\n\n  return {\n    config,\n    autoLocale: options.autoLocale ?? false,\n    defaultLocale: options.defaultLocale || keys(config).pop()!,\n    localeFallback: options.localeFallback ?? true,\n    defaultBehavior:\n      options.defaultBehavior &&\n      AVAILABLE_FALLBACK.includes(options.defaultBehavior)\n        ? options.defaultBehavior\n        : 'defaultLocale',\n  }\n}\n","const HASH_REGEXP = /#.*$/u\n\nexport const normalizePath = (path: string, removeHash = false): string =>\n  (removeHash ? path.replace(HASH_REGEXP, '') : path)\n    .replace(/\\/(?:README\\.md)?$/i, '/index.html')\n    .replace(/(?:\\.(?:md|html))?$/, '.html')\n","import {\n  entries,\n  fromEntries,\n  isArray,\n  isFunction,\n  isPlainObject,\n} from '@vuepress/helper'\nimport type { App, Page } from 'vuepress/core'\nimport { normalizePath } from '../shared/normalizePath.js'\nimport type {\n  RedirectPluginFrontmatter,\n  RedirectPluginOptions,\n} from './types/index.js'\n\nexport const getRedirectMap = (\n  app: App,\n  options: RedirectPluginOptions,\n): Record<string, string> => {\n  const config = isFunction(options.config)\n    ? options.config(app)\n    : isPlainObject(options.config)\n      ? options.config\n      : {}\n\n  return {\n    ...fromEntries(\n      (app.pages as Page<Record<string, never>, RedirectPluginFrontmatter>[])\n        .map<\n          [string, string][]\n        >(({ frontmatter, path }) => (isArray(frontmatter.redirectFrom) ? frontmatter.redirectFrom.map((from) => [normalizePath(from, true), path]) : frontmatter.redirectFrom ? [[normalizePath(frontmatter.redirectFrom, true), path]] : []))\n        .flat(),\n    ),\n    ...fromEntries(\n      entries(config).map(([from, to]) => [\n        normalizePath(from, true),\n        normalizePath(to),\n      ]),\n    ),\n  }\n}\n","import { isLinkAbsolute, removeLeadingSlash } from '@vuepress/helper'\nimport type { App, Page } from 'vuepress/core'\nimport { normalizePath } from '../shared/normalizePath.js'\nimport type { RedirectPluginFrontmatter } from './types/index.js'\n\nexport const handleRedirectTo = ({ frontmatter }: Page, app: App): void => {\n  const { base } = app.siteData\n  const { redirectTo } = frontmatter as RedirectPluginFrontmatter\n\n  if (redirectTo) {\n    const redirectUrl = normalizePath(\n      isLinkAbsolute(redirectTo)\n        ? `${base}${removeLeadingSlash(redirectTo)}`\n        : redirectTo,\n    )\n\n    ;(frontmatter.head ??= []).unshift([\n      'script',\n      {},\n      `{\\\nconst anchor = window.location.hash.slice(1);\\\nwindow.location.replace(\\`${redirectUrl}\\${anchor? \\`#\\${anchor}\\`: \"\"}\\`);\\\n}`,\n    ])\n  }\n}\n","import type { DefaultLocaleInfo } from '@vuepress/helper'\nimport type { RedirectPluginLocaleData } from '../shared/index.js'\n\n/**\n * Default locale info for `@vuepress/plugin-redirect`\n */\nexport const redirectLocaleInfo: DefaultLocaleInfo<RedirectPluginLocaleData> = [\n  [\n    ['en', 'en-US'],\n    {\n      name: 'English',\n      hint: 'Your primary language is $1, do you want to switch to it?',\n      switch: 'Switch to $1',\n      cancel: 'Cancel',\n      remember: 'Remember my choice',\n    },\n  ],\n  [\n    ['zh', 'zh-CN', 'zh-Hans'],\n    {\n      name: '简体中文',\n      hint: '你的首选语言是 $1，是否切换到该语言？',\n      switch: '切换到 $1',\n      cancel: '取消',\n      remember: '记住我的选择',\n    },\n  ],\n  [\n    ['zh-TW', 'zh-Hant'],\n    {\n      name: '繁體中文',\n      hint: '你的首選語言是 $1，是否切換到該語言？',\n      switch: '切換到 $1',\n      cancel: '取消',\n      remember: '記住我的選擇',\n    },\n  ],\n  [\n    ['de', 'de-DE'],\n    {\n      name: 'Deutsch',\n      hint: 'Ihre bevorzugte Sprache ist $1, möchten Sie zu dieser wechseln?',\n      switch: 'Zu $1 wechseln',\n      cancel: 'Abbrechen',\n      remember: 'Meine Wahl merken',\n    },\n  ],\n  [\n    ['de-AT'],\n    {\n      name: 'Deutsch (Österreich)',\n      hint: 'Ihre bevorzugte Sprache ist $1, möchten Sie zu dieser wechseln?',\n      switch: 'Zu $1 wechseln',\n      cancel: 'Abbrechen',\n      remember: 'Meine Wahl merken',\n    },\n  ],\n  [\n    ['vi', 'vi-VN'],\n    {\n      name: 'Tiếng Việt',\n      hint: 'Ngôn ngữ chính của bạn là $1, bạn có muốn chuyển sang nó?',\n      switch: 'Chuyển sang $1',\n      cancel: 'Hủy',\n      remember: 'Nhớ lựa chọn của tôi',\n    },\n  ],\n  [\n    ['uk'],\n    {\n      name: 'Українська',\n      hint: 'Вашою основною мовою є $1, чи бажаєте ви переключитися на неї?',\n      switch: 'Переключитися на $1',\n      cancel: 'Скасувати',\n      remember: 'Запам’ятати мій вибір',\n    },\n  ],\n  [\n    ['ru', 'ru-RU'],\n    {\n      name: 'Русский',\n      hint: 'Ваш основной язык - $1, вы хотите переключиться на него?',\n      switch: 'Переключиться на $1',\n      cancel: 'Отмена',\n      remember: 'Запомнить мой выбор',\n    },\n  ],\n  [\n    ['br'],\n    {\n      name: 'Português (Brasil)',\n      hint: 'A língua principal é $1, deseja mudar para ela?',\n      switch: 'Mudar para $1',\n      cancel: 'Cancelar',\n      remember: 'Lembrar minha escolha',\n    },\n  ],\n  [\n    ['pl', 'pl-PL'],\n    {\n      name: 'Polski',\n      hint: 'Twoim głównym językiem jest $1, czy chcesz przełączyć się na niego?',\n      switch: 'Przełącz na $1',\n      cancel: 'Anuluj',\n      remember: 'Zapamiętaj moje wybory',\n    },\n  ],\n  [\n    ['sk', 'sk-SK'],\n    {\n      name: 'Slovenčina',\n      hint: 'Vašou hlavnou jazykom je $1, chcete prepnúť naň?',\n      switch: 'Prepnúť na $1',\n      cancel: 'Zrušiť',\n      remember: 'Zapamätať si moju voľbu',\n    },\n  ],\n  [\n    ['fr', 'fr-FR'],\n    {\n      name: 'Français',\n      hint: 'Votre langue principale est $1, voulez-vous la changer ?',\n      switch: 'Changer pour $1',\n      cancel: 'Annuler',\n      remember: 'Se souvenir de mon choix',\n    },\n  ],\n  [\n    ['tr', 'tr-TR'],\n    {\n      name: 'Türkçe',\n      hint: 'Ana diliniz $1, ona geçmek ister misiniz?',\n      switch: \"$1'e geç\",\n      cancel: 'İptal',\n      remember: 'Seçimimi hatırla',\n    },\n  ],\n  [\n    ['fi', 'fi-FI'],\n    {\n      name: 'Suomi',\n      hint: 'Pääkielenäsi on $1, haluatko vaihtaa siihen?',\n      switch: 'Vaihda $1:een',\n      cancel: 'Peruuta',\n      remember: 'Muista valintani',\n    },\n  ],\n  [\n    ['hu', 'hu-HU'],\n    {\n      name: 'Magyar',\n      hint: 'A fő nyelvét $1, szeretné váltani?',\n      switch: 'Váltás $1',\n      cancel: 'Mégse',\n      remember: 'Emlékezzen a választásomra',\n    },\n  ],\n  [\n    ['id', 'id-ID'],\n    {\n      name: 'Bahasa Indonesia',\n      hint: 'Bahasa utama Anda adalah $1, apakah Anda ingin beralih ke sana?',\n      switch: 'Beralih ke $1',\n      cancel: 'Batal',\n      remember: 'Ingat pilihan saya',\n    },\n  ],\n  [\n    ['nl', 'nl-NL'],\n    {\n      name: 'Nederlands',\n      hint: 'Uw primaire taal is $1, wilt u overschakelen?',\n      switch: 'Overschakelen naar $1',\n      cancel: 'Annuleren',\n      remember: 'Onthoud mijn keuze',\n    },\n  ],\n  [\n    ['ja', 'ja-JP'],\n    {\n      name: '日本語',\n      hint: 'あなたの主要な言語は $1 です。それに切り替えますか？',\n      switch: '$1 に切り替える',\n      cancel: 'キャンセル',\n      remember: '選択を記憶する',\n    },\n  ],\n  [\n    ['ko', 'ko-KO'],\n    {\n      name: '한국어',\n      hint: '당신의 기본 언어는 $1입니다. 그것으로 전환 하시겠습니까?',\n      switch: '$1로 전환',\n      cancel: '취소',\n      remember: '내 선택 기억하기',\n    },\n  ],\n  [\n    ['es', 'es-ES'],\n    {\n      name: 'Español',\n      hint: 'Su idioma principal es $1, ¿desea cambiarlo?',\n      switch: 'Cambiar a $1',\n      cancel: 'Cancelar',\n      remember: 'Recordar mi elección',\n    },\n  ],\n  [\n    ['/pt'],\n    {\n      name: 'Português',\n      hint: 'Sua língua principal é $1, deseja mudar para ela?',\n      switch: 'Mudar para $1',\n      cancel: 'Cancelar',\n      remember: 'Lembrar minha escolha',\n    },\n  ],\n]\n","import {\n  addViteSsrNoExternal,\n  getFullLocaleConfig,\n  getModulePath,\n} from '@vuepress/helper'\nimport type { PluginFunction } from 'vuepress/core'\nimport { getDirname, path } from 'vuepress/utils'\nimport { ensureRootHomePage } from './ensureRootHomePage.js'\nimport {\n  generateAutoLocaleRedirectFiles,\n  generateRedirectFiles,\n} from './generate/index.js'\nimport { getRedirectBehaviorConfig } from './getRedirectLocaleConfig.js'\nimport { getRedirectMap } from './getRedirectMap.js'\nimport { handleRedirectTo } from './handleRedirectTo.js'\nimport { redirectLocaleInfo } from './locales.js'\nimport { PLUGIN_NAME, logger } from './logger.js'\nimport type { RedirectPluginOptions } from './types/index.js'\n\nconst { url } = import.meta\nconst __dirname = getDirname(url)\n\nexport const redirectPlugin =\n  (options: RedirectPluginOptions = {}): PluginFunction =>\n  (app) => {\n    if (app.env.isDebug) logger.info('Options:', options)\n\n    const behaviorConfig = getRedirectBehaviorConfig(app, options)\n    let redirectMap: Record<string, string> | null = null\n\n    return {\n      name: PLUGIN_NAME,\n\n      alias: {\n        '@vuepress/plugin-redirect/modal':\n          options.switchLocale === 'modal'\n            ? path.resolve(__dirname, '../client/components/RedirectModal.js')\n            : getModulePath('@vuepress/helper/noopComponent', import.meta),\n      },\n\n      define: {\n        __REDIRECT_CONFIG__: behaviorConfig,\n        __REDIRECT_DIRECT__: options.switchLocale === 'direct',\n        __REDIRECT_MODAL__: options.switchLocale === 'modal',\n        __REDIRECT_LOCALES__: getFullLocaleConfig({\n          app,\n          name: 'redirect',\n          config: options.locales,\n          default: redirectLocaleInfo,\n        }),\n      },\n\n      extendsBundlerOptions: (bundlerOptions: unknown): void => {\n        addViteSsrNoExternal(bundlerOptions, app, '@vuepress/helper')\n      },\n\n      extendsPage: (page) => {\n        handleRedirectTo(page, app)\n      },\n\n      onInitialized: async (): Promise<void> => {\n        redirectMap = getRedirectMap(app, options)\n\n        if (app.env.isDebug) logger.info('Redirect Map:', redirectMap)\n\n        if (options.autoLocale && app.env.isDebug) await ensureRootHomePage(app)\n      },\n\n      onPrepared: async (): Promise<void> => {\n        await app.writeTemp(\n          'redirect/map.js',\n          `\\\nexport const redirectMap = ${\n            app.env.isDev ? JSON.stringify(redirectMap, null, 2) : '{}'\n          };\n`,\n        )\n        // clean redirectMap reference in dev server\n        if (app.env.isDev) redirectMap = null\n      },\n\n      onGenerated: async (): Promise<void> => {\n        await generateRedirectFiles(app, redirectMap!)\n        if (options.autoLocale)\n          await generateAutoLocaleRedirectFiles(app, behaviorConfig)\n      },\n\n      clientConfigFile: path.join(__dirname, '../client/config.js'),\n    }\n  }\n"],"names":["ensureRootHomePage","app","path","createPage","PLUGIN_NAME","logger","Logger","getLocaleRedirectHTML","config","defaultBehavior","defaultLocale","localeFallback","availableLocales","base","removeEndingSlash","generateAutoLocaleRedirectFiles","localeOptions","rootPaths","pathLocale","pagePath","localeRedirectMap","rootPath","succeed","entries","filePath","removeLeadingSlash","fs","getRedirectHTML","redirectUrl","generateRedirectFiles","hostname","resolvedHostname","isLinkHttp","from","to","isLinkAbsolute","AVAILABLE_FALLBACK","getRedirectBehaviorConfig","options","locales","deepAssign","fromEntries","key","lang","colors","isPlainObject","routePath","isArray","keys","HASH_REGEXP","normalizePath","removeHash","getRedirectMap","isFunction","frontmatter","handleRedirectTo","redirectTo","redirectLocaleInfo","url","__dirname","getDirname","redirectPlugin","behaviorConfig","redirectMap","getModulePath","getFullLocaleConfig","bundlerOptions","addViteSsrNoExternal","page"],"mappings":"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"}